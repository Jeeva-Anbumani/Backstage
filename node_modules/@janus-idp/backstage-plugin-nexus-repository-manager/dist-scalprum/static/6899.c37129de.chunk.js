(self.webpackChunkjanus_idp_backstage_plugin_nexus_repository_manager=self.webpackChunkjanus_idp_backstage_plugin_nexus_repository_manager||[]).push([[6899],{43988:(e,n,t)=>{"use strict";t.r(n),t.d(n,{NexusRepositoryManager:()=>E});var i,a,r,s,o,l=t(52322),d=(t(64821),t(23860)),u=t(36946),p=t(8069),c=t(78373);t(72779),function(e){e.Completed="Completed"}(i||(i={})),(o=a||(a={})).All="All",o.Cancelling="Cancelling",o.Succeeded="Succeeded",o.Failed="Failed",o.Running="Running",o["In Progress"]="In Progress",o.FailedToStart="FailedToStart",o.PipelineNotStarted="PipelineNotStarted",o.Skipped="Skipped",o.Cancelled="Cancelled",o.Pending="Pending",o.Idle="Idle",o.Other="Other",(s=r||(r={})).PipelineRunCancelled="StoppedRunFinally",s.PipelineRunStopped="CancelledRunFinally",s.TaskRunCancelled="TaskRunCancelled",s.Cancelled="Cancelled",s.PipelineRunStopping="PipelineRunStopping",s.PipelineRunPending="PipelineRunPending",s.TaskRunStopping="TaskRunStopping",s.CreateContainerConfigError="CreateContainerConfigError",s.ExceededNodeResources="ExceededNodeResources",s.ExceededResourceQuota="ExceededResourceQuota",s.ConditionCheckFailed="ConditionCheckFailed";var g=t(38341);function h(e){if(!e||-1===e)return"N/A";const n="number"==typeof e?1e3*e:e;return(0,g.default)(new Date(n),"LLL d, yyyy, h:mm a")}var y=t(58272),m=t(26762),f=t(99135);const v=(0,y.U)({createUnitDependencies:m.E,unitDependencies:f.J}),x=["B","kB","MB","GB","TB","PB","EB","ZB","YB"];t(46782),t(76635);var C=t(19701),N=t(25033);const R=({entity:e,ANNOTATIONS:n})=>{const t=n.reduce(((n,t)=>{var i;const a=null==e||null===(i=e.metadata.annotations)||void 0===i?void 0:i[t.annotation];if(!a)return n;n.repositories.push(a);const r=t.query?Object.assign(n.query,t.query(a),{sort:"version"}):n.query;return{...n,query:r}}),{repositories:[],query:{}});if(0===t.repositories.length)throw new Error("A Nexus Repository Manager annotation could not be found");let i;return N.sb.forEach((n=>{if("nexus-repository-manager/config.title"!==n.annotation){const e=n.annotation;throw new Error(`Unhandled annotation case: ${e}`)}var t;i=null==e||null===(t=e.metadata.annotations)||void 0===t?void 0:t[n.annotation]})),{title:null!=i?i:t.repositories.join(" | "),query:t.query}};var S=t(71465),j=t(79692),A=t(95544),T=t(7089);const b=(0,j.Z)((e=>({chip:{margin:0,marginRight:".2em",height:"1.5em","& > span":{padding:".3em"}},empty:{padding:e.spacing(2),display:"flex",justifyContent:"center"}}))),k=({artifacts:e,title:n})=>{const t=b(),i=[{title:"Version",field:"version",type:"string",highlight:!0},{title:"Artifact",field:"artifact",type:"string",render:e=>(0,l.jsxs)(l.Fragment,{children:[e.artifact,(0,l.jsx)(A.Z,{sx:{display:"flex",alignItems:"center",flexWrap:"wrap",marginTop:"0.2em"},children:[...e.assetVariants].sort(((e,n)=>e.localeCompare(n))).reverse().map((e=>(0,l.jsx)(T.Z,{label:e,className:t.chip},e)))})]})},{title:"Repository Type",field:"repositoryType",type:"string"},{title:"Checksum",field:"hash",emptyValue:"N/A",render:e=>{var n,i;return(0,l.jsxs)(A.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(T.Z,{label:null===(n=e.hash)||void 0===n?void 0:n.algorithm,className:t.chip}),null===(i=e.hash)||void 0===i?void 0:i.value.slice(0,12)]})},customFilterAndSearch:(e,n)=>!!n.hash&&n.hash.value.includes(e),customSort:(e,n)=>e.hash?n.hash?e.hash.value===n.hash.value?0:e.hash.value<n.hash.value?-1:1:1:-1},{title:"Modified",field:"lastModified",type:"string"},{title:"Size",field:"sizeBytes",render:e=>function(e){if(!e)return"N/A";const n=Math.floor(Math.log10(e)/3);return v.unit(e,"B").to(x[n]).format({precision:3,notation:"auto"})}(e.sizeBytes)}];return(0,l.jsx)(u.iA,{title:`Nexus Repository Manager: ${n}`,options:{paging:!0,padding:"dense"},data:e,columns:i,emptyContent:(0,l.jsxs)("div",{className:t.empty,"data-testid":"nexus-repository-manager-empty-table",children:["No data was added yet,Â ",(0,l.jsx)(u.rU,{to:"https://github.com/janus-idp/backstage-plugins/blob/main/plugins/nexus-repository-manager/ANNOTATIONS.md",children:"learn how to add data"}),"."]})})};function P(e){var n;return new Set(null===(n=e.assets)||void 0===n?void 0:n.flatMap((e=>{if(!e.maven2)return[];const{classifier:n,extension:t}=e.maven2;return"jar"===t&&n?`+${n}`:(0,S.NE)(e)&&t?t:[]})))}function E(){const e=(0,p.useApi)(C.w),{entity:n}=(0,c.u)(),{ANNOTATIONS:t}=e.getAnnotations(),{title:i,query:a}=R({entity:n,ANNOTATIONS:t}),{value:r=[],loading:s}=(0,d.Z)((async()=>(await e.getComponents(a)).components));if(s)return(0,l.jsx)("div",{"data-testid":"nexus-repository-manager-loading",children:(0,l.jsx)(u.Ex,{})});const o=null==r?void 0:r.map((e=>{var n;const{component:t}=e,i=null===(n=t.assets)||void 0===n?void 0:n.find(S.NE);return{id:t.id,version:t.version,artifact:"maven2"===t.format&&t.group?`${t.group}:${t.name}`:t.name,assetVariants:P(t),repositoryType:t.repository,hash:(0,S.XR)(i),lastModified:h(null==i?void 0:i.lastModified),sizeBytes:(0,S.hR)(e)}}));return(0,l.jsx)("div",{style:{border:"1px solid #ddd"},"data-testid":"nexus-repository-manager-table",children:(0,l.jsx)(k,{title:i,artifacts:o})})}},53260:()=>{}}]);
//# sourceMappingURL=6899.c37129de.chunk.js.map